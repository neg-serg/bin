#!/bin/zsh

main(){
    local main_detect=$(tmux -S ~/1st_level/main.socket list-sessions|awk -F ':' '/main/ {print $1}')
    local term_name="MainTerminal"
    local session_name="main"

    local main_term_fn="${fn_name}:size=${fn_size}"

    if [[ ${main_detect} != "main" ]]; then
        wid=$(xdotool search --classname ${term_name})
        args_new=(
            -t "${term_name}" -e dash -c "~/bin/dynamic-colors switch dark3; tmux -S ~/1st_level/main.socket new-session -s ${session_name} && tmux -S ~/1st_level/main.socket a -t ${session_name}"
        )
        if [[ -z "${wid}" ]]; then
            alacritty ${args_new} 
        fi
    else
        args_existing=(
            -t "${term_name}" -e dash -c "~/bin/dynamic-colors switch dark3; tmux -S ~/1st_level/main.socket a -t ${session_name}"
        )
        alacritty ${args_existing} 
    fi
}

main "$@"
